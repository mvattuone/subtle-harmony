{"version":3,"file":"main.js","sourceRoot":"","sources":["/Users/vattuonet/Sites/subtle-harmony/assets/js/main.coffee"],"names":[],"mappings":"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","sourcesContent":["getRandomScTrack = () ->\n  SC.get \"/tracks\", (tracks) ->\n    randomTrack = tracks[Math.floor(tracks.length * Math.random())]\n    $(\"#audio\").prop(\"src\", randomTrack['stream_url'] + \"?client_id=\" + app.SC_CLIENT_ID)\n\nhandleExecution = (response) -> \n  console.log app.nextPageToken\n  app.nextPageToken = response[\"nextPageToken\"]\n\n  search_videos = []\n  for search_result in response[\"items\"]\n    search_videos.push(search_result[\"id\"][\"videoId\"])\n    video_ids = search_videos.join(\",\")\n\n  app['youtube'].videos.list(\n    id: video_ids\n    part: 'contentDetails'\n  ).execute(handleDetailExecution)\n\n\nhandleDetailExecution = (response) ->\n  for r in response[\"items\"]\n    duration = r['contentDetails']['duration']\n  \n    reptms = /^PT(?:(\\d+)H)?(?:(\\d+)M)?(?:(\\d+)S)?$/;\n    hours = 0 \n    minutes = 0\n    seconds = 0\n\n    if reptms.test(duration)\n      matches = reptms.exec(duration);\n      if matches[1] then hours = Number(matches[1]);\n      if matches[2] then minutes = Number(matches[2]);\n      if matches[3] then seconds = Number(matches[3]);\n      \n    match = false\n    app.video_duration = new Date(0,0,hours,minutes,seconds,0,0,0,0)\n    if app.video_duration.getMinutes() == app.audio_duration.getMinutes() and app.video_duration.getSeconds() == app.audio_duration.getSeconds()\n      alert('yahoo')\n      match = true\n      # if we find a match, return the id of that video\n  \n      app['video_id'] = r['id'] \n      onPlayerStateChange = (event) ->\n        if event.data == YT.PlayerState.PLAYING && !done\n            console.log('cool')\n      \n      onPlayerReady = (event) ->\n        event.target.playVideo()\n        event.target.mute()\n        $('#audio')[0].play()\n          \n      player = new YT.Player 'player', \n        height: '700'\n        width: '1000'\n        videoId: app['video_id']\n        events: \n          'onReady': onPlayerReady\n          'onStateChange': onPlayerStateChange\n      break\n    else\n      continue\n  \n  if not match\n    handleSearch()\n\n\nhandleSearch = () ->\n  youtube = app.youtube\n  if app.nextPageToken\n    console.log 'great'\n    videos = youtube.search.list(\n      part: \"id\"\n      maxResults: 50\n      pageToken:app.nextPageToken\n    ).execute(handleExecution)\n  else\n    console.log 'great just once'\n    videos = youtube.search.list(\n      part:\"id\"\n      maxResults:50\n    ).execute(handleExecution)\n\nsetEvents = () ->\n  $('#randomSC').click (e) -> \n    getRandomScTrack()\n    \n  $(\"#audio\").on \"canplaythrough\", (e) ->\n    app.audio_duration = new Date(0,0,0,0,e.currentTarget.duration,0,0,0,0)\n    \n    \n\n    gapi.client.load 'youtube', 'v3', () ->\n      app['youtube'] = gapi.client.youtube\n      handleSearch()\n    \n  $(\"#uploadAudio\").change (e) ->\n      file = e.currentTarget.files[0]\n      objectUrl = URL.createObjectURL(file)\n      $(\"#audio\").prop(\"src\", objectUrl)\n\n\nwindow.onload = () ->\n  app = window.app = {}\n  \n  # API keys\n  app.YT_DEVELOPER_KEY = 'AIzaSyBbIBg0lplyaKf_q84lQAZ28BZjE41D7ok'\n  app.SC_CLIENT_ID = \"c285d5176201ed3602694e63b50e5221\"\n\n  # init YT api\n  gapi.client.setApiKey(app.YT_DEVELOPER_KEY)\n  \n  # init SC api\n  SC.initialize\n    client_id: app.SC_CLIENT_ID\n\n\n  # add event handling\n  setEvents()\n\n\n\n\n\n\n\n"]}